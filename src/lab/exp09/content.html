<!-- This file needs to be edited by the lab developer to suit
the requirements of their lab in particular.-->

<!-- Add class="default" to include any element as it is
specified in default.html. 
Do not include class="default" to the elements that you want to
edit -->

<!DOCTYPE html>
<html>
<head></head>
<body>

<div id="experiment"> <!-- The Experiment Document Container-->

  <!-- The lab Header contains the logo and the name of the lab,
  usually displayed on the top of the page-->

  <header id="experiment-header" class="default">
  
    <div id="experiment-header-logo" class="logo">
      <!-- Enclose the logo image of your lab or write it in 
      text
      <img src="../images/logo.jpg" />
	-->
    </div>

    <div id="experiment-header-heading" class="heading">
      <!-- Write the name of your lab and link it to the home 
      page of your lab (h1 tag is preferred while writing your 
      lab name)-->
      <a href="../index.html">Speech Signal Processing Virtual Lab</a>	
    </div>

    <!-- Add any additional element you want to add to the lab 
    header, For example : Help (Enclosing them with suitable 
    div is recommended)-->

  </header>


  <!-- The lab article is the main content area where all the 
  experiment content sits-->
  <article id="experiment-article">
  
    <!-- The lab article has an header, optional navigational 
    menu, number of sections, an optional sidebar and a closing 
    footer-->
    
      <header id="experiment-article-heading" class="heading">
        <!-- You can add a welcome message or title of the 
        experiment here -->
        Expt-9: Formant Synthesis
        <!-- Add any additional element if required with proper 
        enclosing-->
      </header>

      <!-- Navigation menu is useful to organize the view of 
      multiple sections inside the article-->
      <nav id="experiment-article-navigation" class="default">
        <ul id="experiment-article-navigation-menu">
          <!-- The menu can be dynamically generated to contain 
          the headings of your sections or instead write the 
          menu items of your choice individually enclosedu in 
          <li> tag as shown below-->
        </ul>
      </nav>

      <!-- All the sections of your lab or experiment can be 
      enclosed together with a div element as shown below-->
      <div id="experiment-article-sections">

        <!-- First section of the article-->
        <section id="experiment-article-section-1">
          
          <div id="experiment-article-section-1-icon" 
          class="icon">
	    <!-- Enclose the icon image of your lab -->
	    <img src="../images/introduction.jpg" />
	  </div>	
          
          <!-- The heading for the section can be enclosed in a 
          div tag. -->
          <div id="experiment-article-section-1-heading" 
          class="heading">
            Objective
          </div>

          <!-- Write the section content inside a paragraph 
          element, You can also include images with <img> tag -->
          <div id="experiment-article-section-1-content" 
          class="content">	
            <p>
	    <!-- PUT CONTENT HERE -->
	    The objective of this experiment is to study the relation between formant frequencies of a vocal tract system and the perception of sounds.
This is achieved through construction of a source-system based formant synthesizer.
An all-pole filter designed for a given set of formant frequencies is used as the system. 
The all-pole system is excited with a train of impulses as the excitation source signal constructed using the pitch information.</p>
        </div>


      </section>

      <!-- Second section of the article-->
      


      <section id="experiment-article-section-3">
        
        <div id="experiment-article-section-3-icon" 
        class="icon">
	  <!-- Enclose the icon image of your lab. -->
	  <img src="../images/theory.jpg" />
	  
	</div>
     
        <div id="experiment-article-section-3-heading" 
        class="heading">
          Tutorial
        </div>

        <div id="experiment-article-section-3-content" 
        class="content">
	    <!-- PUT CONTENT HERE -->
<style type="text/css">
<!--
@page { margin: 0.79in }
P { margin-bottom: 0.08in }
TD P { margin-bottom: 0in }
-->
</style>
<p style="margin-bottom: 0.2in;"><b>Synthesizing vowels </b>
</p>
<p style="margin-bottom: 0in;">The objective of the experiment is to synthesize a vowel given its first three formant frequencies  <font size=-1>\(F_1\)</font>, <font size=-1>\(F_2\)</font>, and <font size=-1>\(F_3\)</font>, the fundamental period <font size=-1>\(T_0\)</font>, and the sampling frequency <font size=-1>\(F_s\)</font> (or the equivalent sampling interval <font size=-1>\(T=1/F_s\)</font>).
The system used in the synthesis of vowels is an all pole filter as shown in Figure 1.
</p>
<br>
<div style="text-align: center;"><img
style="width: 300px; height: 100px; " alt="Figure 1: All-pole filter."
src="media/block.png"></div>
<p align="center"><strong>Figure 1: </strong><i>All-pole filter.</i></p>
<br>

<p align=justify>
The tranfer function <i>H(z)</i> of the all-pole system is given by
<font size=-1>
$$ H(z) = \frac{1}{1+\sum^{N}_{k=1}{{a_k z^{-k}}}}, \qquad (1) $$
</font>
where <font size=-1>\(\{a_k\}\)</font>s denote the real coefficients of the denominator polynomial of order <font size=-1>\(N\)</font>.
Roots of the denominator polynomial in <font size=-1>\(z^{-1}\)</font> can be either real or complex.
Real roots correspond to zero frequency or <font size=-1>\(F_s/2\)</font>.
Complex roots of a polynomial with real coefficients always occur in complex conjugate pairs corresponding to a frequency related to the angle of the complex root.
Each pair of complex conjugate roots (or poles) corresponds to a second order polynomial which may be denoted as
<font size=-1>
$$ H_i(z) = \frac{1}{(1-z_iz^{-1})(1-z_i^*z^{-1})} = \frac{1}{1+a_{i_1}z^{-1}+a_{i_2}z^{-2}}, \qquad (2)$$
</font>
where the complex root <font size=-1>\(z_i\)</font> is given by
<font size=-1>
$$ 
z_i=r_i e^{j2\pi\frac{F_i}{F_s}}, \qquad (3)
$$
</font>
where <font size=-1>\(F_i\)</font> denotes the resonance frequency of the second order system, and <font size=-1>\(r_i\)</font> corresponds to the resonance bandwidth <font size=-1>\(B_i\)</font> given by
<font size=-1>
$$ 
r_i=e^{-\pi B_i T}, \qquad (4)
$$
</font>
where <font size=-1>\(T\)</font> denotes the sampling interval.

Now, each of the formant frequencies correspond to a resonance that can be generated by a second order all-pole system given by
<font size=-1>
$$ H_i(z) = \frac{1}{1 - 2 e^{(-\pi B_i T)} cos(2 \pi F_i T) z^{-1} + e^{(-2 \pi B_i T)} z^{-2}}. \qquad (5) $$
</font>

Compute the coefficients of the second order filter for each of the formant frequencies.
The combined system to synthesize the vowel can be constructed by cascading the individual second order filters given by
<font size=-1>
$$ H_i(z) = \prod_{i=1}^{M} H_i(z), \qquad (6) $$
</font>
where <font size=-1>\(M\)</font> denotes the number of formant frequencies used to build the synthesizer.
The coefficients of denominator polynomial of the combined system can be obtained by convolving the coefficient sequences of the individual second order filters.
</p>

<p>The source used for excitation is a
periodic unit sample sequence. Generate unit sample sequence of
required length, depending on the length of the speech segment to be
generated. 
</p>
<p>The vowel sound is synthesized by exciting the combined all-pole system with the generated excitation sequence.
This can be implemented using a simple difference equation that can be derived from Eq. (1).
</p>

<p><b>Illustration of Synthesizing Vowel </b><i><b>/a/</b></i><b>:</b></p>
<ul>
<li>
<p>
Given,
<ul>
<li>formant frequencies F<sub>1</sub> = 560 Hz, F<sub>2</sub>= 1180 Hz, and F<sub>3</sub>= 2480 Hz </li>
<li>pitch period, T<sub>0 </sub>= 7.5msec </li>
<li>sampling frequency, F<sub>s</sub>=10000Hz</li>
</ul>
</p>
</li>
<li>
<p> For a given formant frequency F<sub>i</sub>, let its bandwidth be B<sub>i</sub> = 0.1* F<sub>i</sub> </p>
</li>
<li>
<p>For each (F<sub>i </sub>, B<sub>i) </sub>system parameters are
computed using Eq. (2), where the sampling interval (1/F<sub>s</sub>) used is 100*10<sup>-6</sup>
sec, for a sampling rate of 10 kHz.</p>
</li>
<li>
<p>Substituting F<sub>1</sub> = 560 Hz Hz, B<sub>1</sub> = 56 Hz Hz
in Eq. (1) we get </p>
<font size=-1>
$$
H_1(z) = \frac{1}{ 1 - 1.8447*z^{-1} + 0.9654* z^{-2}} \qquad (3)
$$
</font>
</li>
<li>
<p>Substituting F<sub>2</sub>= 1180 Hz Hz, B<sub>2</sub>= 118 Hz Hz
in Eq. (1) we get </p>
<font size=-1>
$$
H_2(z) = \frac{1}{ 1 - 1.4213*z^{-1} + 0.9285* z^{-2}} \qquad (4)
$$
</font>
</li>
<li>
<p>substituting F<sub>3</sub>= 2480 Hz Hz, B<sub>3</sub>= 248 Hz Hz
in Eq. (1) we get </p>
<font size=-1>
$$
H_3(z) = \frac{1}{ 1 - 0.0232*z^{-1} + 0.8557* z^{-2}} \qquad (5)
$$
</font>
</li>
<li>
<p style="margin-bottom: 0in;">The system transfer function <i>H(z)</i>
is given by, <i>H(z)=H</i><sub><i>1</i></sub><i>(z) * H</i><sub><i>2</i></sub><i>(z)
*H</i><sub><i>3</i></sub><i>(z)</i></p>
</li>
<li>
<p style="margin-bottom: 0in;">Substituting for <i>H</i><sub><i>1</i></sub><i>(z),
H</i><sub><i>2</i></sub><i>(z), H</i><sub><i>3</i></sub><i>(z)</i> we get </p>
<font size=-1>
$$
H(z)=\frac{1}{1+a_1z^{-1}+a_2z^{-2}+a_3z^{-3}+a_4z^{-4}+a_5z^{-5}+a_6z^{-6}}. \qquad (6)
$$
</font>
</li>
<li>
<p style="margin-bottom: 0in;">From Eq. (6) we have <font size=-1>\( \{b_k\}\)</font>=[1] and <font size=-1>\( \{a_k\}=\)</font>[1, -3.2892, 5.472, -5.9844, 4.8321, -2.6606, 0.7670]
</p>
</li>
<li>
<p style="margin-bottom: 0in;">We can also compute the <font size=-1>\(\{a_k\}\)</font>s of the combined system by convolving the <font size=-1>\(\{a_k\}\)</font>s of the individual resonators <font size=-1>\(H_1(z)\)</font>, <font size=-1>\(H_2(z)\)</font>, and <font size=-1>\(H_3(z)\)</font>. i.e., by convolving [1,-1.8447,0.9654], [1, -1.4213, 0.9285]), and [1, -0.0232, 0.8557]) </p>
</li>
<li>
<p style="margin-bottom: 0in;">Generate the unit sample sequence to
be used as the excitation at the given pitch period (7.5 msec i.e.,
 75 samples at 10 kHz).
The resulting sequence has ones at every 75 sample interval and all other values are zero.
</li>
<li>
<p>Figure 2 shows the excitation sequence and the signal
synthesized for a particular pitch period. It also shows the excitation
sequence and signal for half the pitch period and twice the pitch
period case. </p>
</li>
<li>
<p>Figures 3, 4, and 5 show the synthesized signals for the sound unit /a/ and
the corresponding spectrograms for excitations with a period of half the
pitch, the given pitch period, and twice the pitch, respectively. </p>
</li>
</ul>
<p style="margin-bottom: 0in;" align="center"><img
style="width: 529px; height: 405px;"
alt="The excitation and the response of the all-pole filter for impulse sequence excitation with a period of 3.75ms, 7.5ms and 15ms respectively."
src="media/lab4.png"><br>
</p>
<p style="margin-bottom: 0in;" align="center"><strong>Figure 2: </strong>
<i>The excitation and the response of the all-pole filter for impulse
sequence excitation with a period of 3.75ms, 7.5ms and 15ms
respectively.</i></p>
<p style="margin-bottom: 0in;" align="center"><img
style="width: 463px; height: 342px;"
alt="Figure 3: Waveform of the the synthesized vowel /a/ and its spectrogram for excitation at half the pitch period."
src="media/hp_spec.png"><br>
</p>
<p style="margin-bottom: 0in;" align="center"><strong>Figure 3: </strong>
<i>Waveform of the the synthesized vowel /a/ and its spectrogram for
excitation at half the pitch period.</i></p>
<p style="margin-bottom: 0in;" align="center"><img
style="width: 463px; height: 342px;"
alt="Figure 4: Waveform of the the synthesized vowel /a/ and its spectrogram for excitation at the pitch period."
src="media/p_spec.png"><br>
</p>
<p style="margin-bottom: 0in;" align="center"><strong>Figure 4: </strong>
<i>Waveform of the the synthesized vowel /a/ and its spectrogram for
excitation at the pitch period.</i></p>
<p style="margin-bottom: 0in;" align="center"><br>
</p>
<p style="margin-bottom: 0in;" align="center"><i><img
style="width: 463px; height: 342px;"
alt="Figure 5: Waveform of the the synthesized vowel /a/ and its spectrogram for excitation at twice the pitch period."
src="media/tp_spec.png"><br>
</i></p>
<p style="margin-bottom: 0in;" align="center"><strong>Figure 5: </strong>
<i>Waveform of the the synthesized vowel /a/ and its spectrogram for
excitation at twice the pitch period.</i></p>
<p>&nbsp;<br>
<br>
</p>
<p style="margin-bottom: 0in;"><br>
</p>

        </div>

      </section>

<section id="experiment-article-section-2">
        
        <div id="experiment-article-section-2-icon" 
        class="icon">
	  <!-- Enclose the icon image of your lab. -->
	  <img src="../images/procedure.jpg" />
	</div>
				
        <!-- The heading for the section can be enclosed in a 
        div tag. -->
        <div id="experiment-article-section-2-heading" 
        class="heading">
          Procedure
        </div>

        <!-- Write the section content inside a paragraph 
        element, we can also include images with <img> tag -->
        <div id="experiment-article-section-2-content" 
        class="content">
	    <!-- PUT CONTENT HERE -->
<p>
The experiment section has three vertical bars on the left pane for choosing the formant frequencies.
The center pane has a vowel chart shown on the <font size=-1>\(F_1-F_2\)</font> plane with the IPA symbols of the vowels shown.
The right pane has a vertical bar for choosing the fundamental frequency <font size=-1>F_0</font>.
The bottom pane displays the waveform of the vowel synthesized using the above chosen parameters using an all-pole source-system model.

</p>
<p>
	<ol >
	<li>Click on the vowel of your choice in the vowel chart in the central pane.</li>
	<li>Listen to the vowel sound several times by clicking on the play button. Note down the formant frequencies of the vowel. Let <font size=-1>\(F_0\)</font> be at 120 Hz (default value).</li>
	<li>Observe the relationship between the vowel sound perceived and the formant frequencies.</li>
	<li>Observe the changes in waveform of different vowels.</li>
	<li>Note that the formant space for vowels is a continuum, and not discrete. A new vowel can be synthesized by clicking in between any two known vowels.</li>
	<li>Synthesize a new vowel by choosing formants frequencies of your choice. Observe how the formant frequencies affect perception.</li>
	<li>Synthesize vowels for different fundamental frequencies <font size=-1>\(F_0\)</font>. Observe how the fundamental frequency affects perception.</li>
	    </ol>
</p>
        </div>
      </section>

      <section id="experiment-article-section-4">

        <div id="experiment-article-section-4-icon" 
        class="icon">
	  <!-- Enclose the icon image of your lab.-->
	  <img src="../images/simulation.jpg" />
	</div>

        <div id="experiment-article-section-4-heading" 
        class="heading">
          Experiment
        </div>

        <div id="experiment-article-section-4-content" 
        class="content">
	    <!-- PUT CONTENT HERE -->
	<p>
	    <applet code=vowelSynthesis.VowelSynthesisApplet.class 
		    archive="media/vowelSynthesis.jar" width=800 height=600>
	      <param name=foo value="bar">
		You need to have Java plugin installed to carry out
		any experiments
	    </applet>
	</p>
        </div>

      </section>

      <section id="experiment-article-section-5">
   
        <div id="experiment-article-section-5-icon" 
        class="icon">
	  <!-- Enclose the icon image of your lab.-->
	  <img src="../images/manual.jpg" />
	</div>

        <div id="experiment-article-section-5-heading" 
        class="heading">
          Observations
        </div>

        <div id="experiment-article-section-5-content" 
        class="content">
	    <!-- PUT CONTENT HERE -->
<ul>
<li>There is a direct correspondence between a set of formant frequencies and a vowel.</li>
<li>The synthesized vowel gives a perception of the expected vowel, except for the loss of naturalness.</li>
<li>The loss of naturalness is mainly due to the approximation of the speech production mechanism by a source-system model.</li>
<li>The system is approximated as an all-pole system which is reasonable for vowel sounds which do not have significant anti-resonances.</li>
<li>The excitation source represented by a train of impulses is not a good approximation and better models of excitation are required to gain naturalness.</li>
</ul>
          </div>

        </section>

        <section id="experiment-article-section-6">
      
          <div id="experiment-article-section-6-icon" 
          class="icon">
	    <img src="../images/quizzes.jpg" />
	  </div>

          <div id="experiment-article-section-6-heading" 
          class="heading">
          	Assessment
          </div>

          <div id="experiment-article-section-6-content" 
          class="content">
          <ul>
          		<li> 
          			<p>
							Draw the output (impulse response) of a second order resonator given by
							$$ H(z)=\frac{1}{(1 - z_1 z^{-1})(1 - z_1^{*} z^{-1})} $$
							for the case
							<ol>
								<ol type=a>
								<li> <p>\(z_1 = \cos(\frac{\pi}{4}) + j \sin(\frac{\pi}{4})\)</p></li>
								<li> <p>\(z_1 = 0.9(\cos(\frac{\pi}{4}) + j \sin(\frac{\pi}{4})\)</p></li>
								</ol></ol>

							Assume a sampling rate of 8kHz. What is the resonance frequence. Also
							draw the pole-zero plot in the z-plane. Which of the two is more likely
							in a physical system such as a resonator cavity and why?	
          			</p>	
          		</li>
          		<li>
						<p>
							Write a program in Octave or Scilab to synthesize a vowel given the first 
							3 formants, corresponding bandwidths, the pitch period and sampling rate.
						</p>          		
          		</li>
          
          </ul>



          </div>

        </section>

			
		


        <section id="experiment-article-section-9">
   
          <div id="experiment-article-section-9-icon" 
          class="icon">
	    <!-- Enclose the icon image of your lab.-->
	    <img src="../images/readings.jpg" />
	  </div>

          <div id="experiment-article-section-9-heading" 
          class="heading">
          References
	  </div>

          <div id="experiment-article-section-9-content" 
          class="content">
<ul>
			<li> <i>Digital Processing of Speech Signals</i>, L.R. Rabiner and L.R. Schafer, Chapter 3</li>
			<li> <i>Discrete-Time Speech Signal Processing</i>, Thomas F. Quatieri , Chapter 4</li>
</ul>     
     
          </div>

        </section>

      </div>


    <!-- An article can have a sidebar that contain related 
    links and additional material (however it is kept optional 
    at this moment) -->
    <aside id="lab-article-sidebar" class="default">
      <!-- put the content that you want to appear in the 
      sidebar -->	
    </aside>


    <!-- Article footer can display related content and 
    additional links -->						
    <footer id="lab-article-footer" class="default">
      <!-- Put the content that you want to appear here -->
    </footer>

  </article>


  <!-- Links to other labs, about us page can be kept the lab 
  footer-->
  <footer id="lab-footer" class="default">
    <!-- Put the content here-->
  </footer>

<footer id="lab-header" class="heading">
    <!-- Put the content here-->
    <div id="lab-header-heading" class="heading">
    <!-- Write the name of your lab and link it to the home page
    of your lab. -->
        <center>
        <table><tr>
                <td><a href="http://speech.iiit.ac.in/" target=_blank><font size=-3>Developed at the Speech and Vision Lab, IIIT Hyderabad</font></a></td>
        </tr></table>
        </center>
    </div>


  </footer>


</div>		
<script type=text/javascript src=../js/MathJax/MathJax.js?config=default></script>
<!--     <script type="text/javascript" src="../js/MathJax/MathJax.js?config=default"></script> -->
</body>
</html>
